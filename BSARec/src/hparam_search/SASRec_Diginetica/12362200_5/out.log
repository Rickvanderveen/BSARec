2025-06-13 19:29:16,761 - Namespace(data_dir='data/self_processed/', output_dir='hparam_search/', data_name='Diginetica', train_name='SASRec_Diginetica', num_items=10, num_users=14829, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='SASRec', max_seq_length=50, hidden_size=64, num_hidden_layers=2, hidden_act='gelu', num_attention_heads=2, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, cuda_condition=True, data_file='data/self_processed/Diginetica.txt', item_size=9441, checkpoint_path=PosixPath('/gpfs/home3/scur2771/BSARec/BSARec/src/hparam_search/SASRec_Diginetica/12362200_5/model.pt'), same_target_path='data/self_processed/Diginetica_same_target.npy')
2025-06-13 19:29:16,784 - SASRecModel(
  (item_embeddings): Embedding(9441, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
        )
      )
      (1): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
        )
      )
    )
  )
)
2025-06-13 19:29:19,825 - Total Parameters: 707520
2025-06-13 19:29:27,443 - {'epoch': 0, 'rec_loss': '1.3054'}
2025-06-13 19:29:31,618 - {'Epoch': 0, 'HR@5': '0.0049', 'NDCG@5': '0.0029', 'HR@10': '0.0086', 'NDCG@10': '0.0041', 'HR@20': '0.0144', 'NDCG@20': '0.0055'}
2025-06-13 19:29:31,620 - Validation score increased.  Saving model ...
2025-06-13 19:29:38,409 - {'epoch': 1, 'rec_loss': '1.1582'}
2025-06-13 19:29:42,689 - {'Epoch': 1, 'HR@5': '0.0164', 'NDCG@5': '0.0113', 'HR@10': '0.0225', 'NDCG@10': '0.0132', 'HR@20': '0.0327', 'NDCG@20': '0.0158'}
2025-06-13 19:29:42,690 - Validation score increased.  Saving model ...
2025-06-13 19:29:49,498 - {'epoch': 2, 'rec_loss': '1.0517'}
2025-06-13 19:29:53,848 - {'Epoch': 2, 'HR@5': '0.0345', 'NDCG@5': '0.0237', 'HR@10': '0.0500', 'NDCG@10': '0.0287', 'HR@20': '0.0702', 'NDCG@20': '0.0338'}
2025-06-13 19:29:53,851 - Validation score increased.  Saving model ...
2025-06-13 19:30:00,591 - {'epoch': 3, 'rec_loss': '0.9479'}
2025-06-13 19:30:04,807 - {'Epoch': 3, 'HR@5': '0.0478', 'NDCG@5': '0.0321', 'HR@10': '0.0743', 'NDCG@10': '0.0406', 'HR@20': '0.1043', 'NDCG@20': '0.0481'}
2025-06-13 19:30:04,811 - Validation score increased.  Saving model ...
2025-06-13 19:30:11,608 - {'epoch': 4, 'rec_loss': '0.8580'}
2025-06-13 19:30:15,903 - {'Epoch': 4, 'HR@5': '0.0661', 'NDCG@5': '0.0431', 'HR@10': '0.1016', 'NDCG@10': '0.0545', 'HR@20': '0.1432', 'NDCG@20': '0.0650'}
2025-06-13 19:30:15,904 - Validation score increased.  Saving model ...
2025-06-13 19:30:22,716 - {'epoch': 5, 'rec_loss': '0.7755'}
2025-06-13 19:30:26,962 - {'Epoch': 5, 'HR@5': '0.0758', 'NDCG@5': '0.0494', 'HR@10': '0.1179', 'NDCG@10': '0.0630', 'HR@20': '0.1701', 'NDCG@20': '0.0761'}
2025-06-13 19:30:26,964 - Validation score increased.  Saving model ...
2025-06-13 19:30:33,715 - {'epoch': 6, 'rec_loss': '0.7001'}
2025-06-13 19:30:37,815 - {'Epoch': 6, 'HR@5': '0.0864', 'NDCG@5': '0.0556', 'HR@10': '0.1314', 'NDCG@10': '0.0701', 'HR@20': '0.1912', 'NDCG@20': '0.0852'}
2025-06-13 19:30:37,815 - Validation score increased.  Saving model ...
2025-06-13 19:30:44,529 - {'epoch': 7, 'rec_loss': '0.6296'}
2025-06-13 19:30:48,613 - {'Epoch': 7, 'HR@5': '0.0962', 'NDCG@5': '0.0623', 'HR@10': '0.1494', 'NDCG@10': '0.0794', 'HR@20': '0.2204', 'NDCG@20': '0.0973'}
2025-06-13 19:30:48,614 - Validation score increased.  Saving model ...
2025-06-13 19:30:55,329 - {'epoch': 8, 'rec_loss': '0.5725'}
2025-06-13 19:30:59,394 - {'Epoch': 8, 'HR@5': '0.1053', 'NDCG@5': '0.0678', 'HR@10': '0.1641', 'NDCG@10': '0.0867', 'HR@20': '0.2391', 'NDCG@20': '0.1056'}
2025-06-13 19:30:59,394 - Validation score increased.  Saving model ...
2025-06-13 19:31:06,091 - {'epoch': 9, 'rec_loss': '0.5235'}
2025-06-13 19:31:10,003 - {'Epoch': 9, 'HR@5': '0.1070', 'NDCG@5': '0.0683', 'HR@10': '0.1680', 'NDCG@10': '0.0879', 'HR@20': '0.2493', 'NDCG@20': '0.1084'}
2025-06-13 19:31:10,004 - Validation score increased.  Saving model ...
2025-06-13 19:31:16,709 - {'epoch': 10, 'rec_loss': '0.4870'}
2025-06-13 19:31:20,682 - {'Epoch': 10, 'HR@5': '0.1134', 'NDCG@5': '0.0731', 'HR@10': '0.1771', 'NDCG@10': '0.0936', 'HR@20': '0.2576', 'NDCG@20': '0.1138'}
2025-06-13 19:31:20,684 - Validation score increased.  Saving model ...
2025-06-13 19:31:27,524 - {'epoch': 11, 'rec_loss': '0.4520'}
2025-06-13 19:31:31,434 - {'Epoch': 11, 'HR@5': '0.1134', 'NDCG@5': '0.0731', 'HR@10': '0.1818', 'NDCG@10': '0.0950', 'HR@20': '0.2679', 'NDCG@20': '0.1166'}
2025-06-13 19:31:31,437 - Validation score increased.  Saving model ...
2025-06-13 19:31:38,079 - {'epoch': 12, 'rec_loss': '0.4304'}
2025-06-13 19:31:41,940 - {'Epoch': 12, 'HR@5': '0.1133', 'NDCG@5': '0.0723', 'HR@10': '0.1859', 'NDCG@10': '0.0957', 'HR@20': '0.2702', 'NDCG@20': '0.1169'}
2025-06-13 19:31:41,941 - Validation score increased.  Saving model ...
2025-06-13 19:31:48,741 - {'epoch': 13, 'rec_loss': '0.4061'}
2025-06-13 19:31:52,573 - {'Epoch': 13, 'HR@5': '0.1157', 'NDCG@5': '0.0735', 'HR@10': '0.1861', 'NDCG@10': '0.0961', 'HR@20': '0.2717', 'NDCG@20': '0.1177'}
2025-06-13 19:31:52,574 - Validation score increased.  Saving model ...
2025-06-13 19:31:59,352 - {'epoch': 14, 'rec_loss': '0.3877'}
2025-06-13 19:32:03,188 - {'Epoch': 14, 'HR@5': '0.1159', 'NDCG@5': '0.0741', 'HR@10': '0.1855', 'NDCG@10': '0.0964', 'HR@20': '0.2725', 'NDCG@20': '0.1183'}
2025-06-13 19:32:03,191 - Validation score increased.  Saving model ...
2025-06-13 19:32:09,962 - {'epoch': 15, 'rec_loss': '0.3756'}
2025-06-13 19:32:13,812 - {'Epoch': 15, 'HR@5': '0.1188', 'NDCG@5': '0.0759', 'HR@10': '0.1839', 'NDCG@10': '0.0969', 'HR@20': '0.2776', 'NDCG@20': '0.1204'}
2025-06-13 19:32:13,814 - Validation score increased.  Saving model ...
2025-06-13 19:32:20,611 - {'epoch': 16, 'rec_loss': '0.3627'}
2025-06-13 19:32:24,481 - {'Epoch': 16, 'HR@5': '0.1171', 'NDCG@5': '0.0759', 'HR@10': '0.1871', 'NDCG@10': '0.0985', 'HR@20': '0.2798', 'NDCG@20': '0.1218'}
2025-06-13 19:32:24,482 - Validation score increased.  Saving model ...
2025-06-13 19:32:31,253 - {'epoch': 17, 'rec_loss': '0.3516'}
2025-06-13 19:32:35,098 - {'Epoch': 17, 'HR@5': '0.1180', 'NDCG@5': '0.0755', 'HR@10': '0.1884', 'NDCG@10': '0.0981', 'HR@20': '0.2796', 'NDCG@20': '0.1211'}
2025-06-13 19:32:35,098 - EarlyStopping counter: 1 out of 10
2025-06-13 19:32:41,765 - {'epoch': 18, 'rec_loss': '0.3434'}
2025-06-13 19:32:45,642 - {'Epoch': 18, 'HR@5': '0.1192', 'NDCG@5': '0.0761', 'HR@10': '0.1924', 'NDCG@10': '0.0995', 'HR@20': '0.2806', 'NDCG@20': '0.1216'}
2025-06-13 19:32:45,646 - EarlyStopping counter: 2 out of 10
2025-06-13 19:32:52,310 - {'epoch': 19, 'rec_loss': '0.3332'}
2025-06-13 19:32:56,248 - {'Epoch': 19, 'HR@5': '0.1194', 'NDCG@5': '0.0758', 'HR@10': '0.1900', 'NDCG@10': '0.0985', 'HR@20': '0.2806', 'NDCG@20': '0.1214'}
2025-06-13 19:32:56,250 - EarlyStopping counter: 3 out of 10
2025-06-13 19:33:02,978 - {'epoch': 20, 'rec_loss': '0.3257'}
2025-06-13 19:33:06,849 - {'Epoch': 20, 'HR@5': '0.1184', 'NDCG@5': '0.0765', 'HR@10': '0.1919', 'NDCG@10': '0.1001', 'HR@20': '0.2847', 'NDCG@20': '0.1235'}
2025-06-13 19:33:06,851 - Validation score increased.  Saving model ...
2025-06-13 19:33:13,609 - {'epoch': 21, 'rec_loss': '0.3176'}
2025-06-13 19:33:17,476 - {'Epoch': 21, 'HR@5': '0.1167', 'NDCG@5': '0.0746', 'HR@10': '0.1905', 'NDCG@10': '0.0983', 'HR@20': '0.2821', 'NDCG@20': '0.1214'}
2025-06-13 19:33:17,478 - EarlyStopping counter: 1 out of 10
2025-06-13 19:33:24,158 - {'epoch': 22, 'rec_loss': '0.3124'}
2025-06-13 19:33:27,966 - {'Epoch': 22, 'HR@5': '0.1185', 'NDCG@5': '0.0755', 'HR@10': '0.1874', 'NDCG@10': '0.0977', 'HR@20': '0.2806', 'NDCG@20': '0.1212'}
2025-06-13 19:33:27,968 - EarlyStopping counter: 2 out of 10
2025-06-13 19:33:34,815 - {'epoch': 23, 'rec_loss': '0.3119'}
2025-06-13 19:33:38,615 - {'Epoch': 23, 'HR@5': '0.1181', 'NDCG@5': '0.0758', 'HR@10': '0.1896', 'NDCG@10': '0.0988', 'HR@20': '0.2825', 'NDCG@20': '0.1222'}
2025-06-13 19:33:38,616 - EarlyStopping counter: 3 out of 10
2025-06-13 19:33:45,337 - {'epoch': 24, 'rec_loss': '0.3047'}
2025-06-13 19:33:49,139 - {'Epoch': 24, 'HR@5': '0.1184', 'NDCG@5': '0.0759', 'HR@10': '0.1898', 'NDCG@10': '0.0988', 'HR@20': '0.2847', 'NDCG@20': '0.1227'}
2025-06-13 19:33:49,142 - EarlyStopping counter: 4 out of 10
2025-06-13 19:33:56,013 - {'epoch': 25, 'rec_loss': '0.2971'}
2025-06-13 19:33:59,882 - {'Epoch': 25, 'HR@5': '0.1209', 'NDCG@5': '0.0771', 'HR@10': '0.1891', 'NDCG@10': '0.0991', 'HR@20': '0.2808', 'NDCG@20': '0.1223'}
2025-06-13 19:33:59,883 - EarlyStopping counter: 5 out of 10
2025-06-13 19:34:06,644 - {'epoch': 26, 'rec_loss': '0.2972'}
2025-06-13 19:34:10,432 - {'Epoch': 26, 'HR@5': '0.1215', 'NDCG@5': '0.0781', 'HR@10': '0.1891', 'NDCG@10': '0.0999', 'HR@20': '0.2814', 'NDCG@20': '0.1231'}
2025-06-13 19:34:10,435 - EarlyStopping counter: 6 out of 10
2025-06-13 19:34:17,215 - {'epoch': 27, 'rec_loss': '0.2899'}
2025-06-13 19:34:21,105 - {'Epoch': 27, 'HR@5': '0.1189', 'NDCG@5': '0.0765', 'HR@10': '0.1880', 'NDCG@10': '0.0987', 'HR@20': '0.2852', 'NDCG@20': '0.1232'}
2025-06-13 19:34:21,106 - EarlyStopping counter: 7 out of 10
2025-06-13 19:34:27,811 - {'epoch': 28, 'rec_loss': '0.2922'}
2025-06-13 19:34:31,566 - {'Epoch': 28, 'HR@5': '0.1191', 'NDCG@5': '0.0764', 'HR@10': '0.1884', 'NDCG@10': '0.0987', 'HR@20': '0.2865', 'NDCG@20': '0.1234'}
2025-06-13 19:34:31,567 - EarlyStopping counter: 8 out of 10
2025-06-13 19:34:38,348 - {'epoch': 29, 'rec_loss': '0.2886'}
2025-06-13 19:34:42,173 - {'Epoch': 29, 'HR@5': '0.1204', 'NDCG@5': '0.0780', 'HR@10': '0.1871', 'NDCG@10': '0.0995', 'HR@20': '0.2839', 'NDCG@20': '0.1238'}
2025-06-13 19:34:42,174 - Validation score increased.  Saving model ...
2025-06-13 19:34:48,981 - {'epoch': 30, 'rec_loss': '0.2860'}
2025-06-13 19:34:52,855 - {'Epoch': 30, 'HR@5': '0.1201', 'NDCG@5': '0.0776', 'HR@10': '0.1874', 'NDCG@10': '0.0993', 'HR@20': '0.2813', 'NDCG@20': '0.1229'}
2025-06-13 19:34:52,859 - EarlyStopping counter: 1 out of 10
2025-06-13 19:34:59,535 - {'epoch': 31, 'rec_loss': '0.2816'}
2025-06-13 19:35:03,345 - {'Epoch': 31, 'HR@5': '0.1206', 'NDCG@5': '0.0770', 'HR@10': '0.1905', 'NDCG@10': '0.0994', 'HR@20': '0.2861', 'NDCG@20': '0.1234'}
2025-06-13 19:35:03,345 - EarlyStopping counter: 2 out of 10
2025-06-13 19:35:10,113 - {'epoch': 32, 'rec_loss': '0.2807'}
2025-06-13 19:35:14,007 - {'Epoch': 32, 'HR@5': '0.1194', 'NDCG@5': '0.0768', 'HR@10': '0.1896', 'NDCG@10': '0.0993', 'HR@20': '0.2841', 'NDCG@20': '0.1232'}
2025-06-13 19:35:14,008 - EarlyStopping counter: 3 out of 10
2025-06-13 19:35:20,670 - {'epoch': 33, 'rec_loss': '0.2778'}
2025-06-13 19:35:24,411 - {'Epoch': 33, 'HR@5': '0.1171', 'NDCG@5': '0.0753', 'HR@10': '0.1872', 'NDCG@10': '0.0977', 'HR@20': '0.2851', 'NDCG@20': '0.1224'}
2025-06-13 19:35:24,412 - EarlyStopping counter: 4 out of 10
2025-06-13 19:35:31,153 - {'epoch': 34, 'rec_loss': '0.2786'}
2025-06-13 19:35:34,929 - {'Epoch': 34, 'HR@5': '0.1176', 'NDCG@5': '0.0753', 'HR@10': '0.1891', 'NDCG@10': '0.0982', 'HR@20': '0.2855', 'NDCG@20': '0.1225'}
2025-06-13 19:35:34,932 - EarlyStopping counter: 5 out of 10
2025-06-13 19:35:41,648 - {'epoch': 35, 'rec_loss': '0.2779'}
2025-06-13 19:35:45,407 - {'Epoch': 35, 'HR@5': '0.1178', 'NDCG@5': '0.0752', 'HR@10': '0.1903', 'NDCG@10': '0.0985', 'HR@20': '0.2853', 'NDCG@20': '0.1225'}
2025-06-13 19:35:45,409 - EarlyStopping counter: 6 out of 10
2025-06-13 19:35:52,148 - {'epoch': 36, 'rec_loss': '0.2729'}
2025-06-13 19:35:55,954 - {'Epoch': 36, 'HR@5': '0.1163', 'NDCG@5': '0.0750', 'HR@10': '0.1907', 'NDCG@10': '0.0989', 'HR@20': '0.2878', 'NDCG@20': '0.1233'}
2025-06-13 19:35:55,955 - EarlyStopping counter: 7 out of 10
2025-06-13 19:36:02,658 - {'epoch': 37, 'rec_loss': '0.2726'}
2025-06-13 19:36:06,407 - {'Epoch': 37, 'HR@5': '0.1163', 'NDCG@5': '0.0745', 'HR@10': '0.1896', 'NDCG@10': '0.0981', 'HR@20': '0.2893', 'NDCG@20': '0.1232'}
2025-06-13 19:36:06,409 - EarlyStopping counter: 8 out of 10
2025-06-13 19:36:13,194 - {'epoch': 38, 'rec_loss': '0.2734'}
2025-06-13 19:36:16,998 - {'Epoch': 38, 'HR@5': '0.1163', 'NDCG@5': '0.0738', 'HR@10': '0.1894', 'NDCG@10': '0.0973', 'HR@20': '0.2876', 'NDCG@20': '0.1221'}
2025-06-13 19:36:16,999 - EarlyStopping counter: 9 out of 10
2025-06-13 19:36:23,715 - {'epoch': 39, 'rec_loss': '0.2696'}
2025-06-13 19:36:27,510 - {'Epoch': 39, 'HR@5': '0.1155', 'NDCG@5': '0.0745', 'HR@10': '0.1905', 'NDCG@10': '0.0986', 'HR@20': '0.2900', 'NDCG@20': '0.1236'}
2025-06-13 19:36:27,513 - EarlyStopping counter: 10 out of 10
2025-06-13 19:36:27,514 - Early stopping
2025-06-13 19:36:27,514 - ---------------Validation Score---------------
2025-06-13 19:36:31,305 - {'Epoch': 0, 'HR@5': '0.1204', 'NDCG@5': '0.0780', 'HR@10': '0.1871', 'NDCG@10': '0.0995', 'HR@20': '0.2839', 'NDCG@20': '0.1238'}
2025-06-13 19:36:31,306 - SASRec_Diginetica
2025-06-13 19:36:31,306 - {'Epoch': 0, 'HR@5': '0.1204', 'NDCG@5': '0.0780', 'HR@10': '0.1871', 'NDCG@10': '0.0995', 'HR@20': '0.2839', 'NDCG@20': '0.1238'}
