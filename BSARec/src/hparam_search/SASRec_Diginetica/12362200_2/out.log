2025-06-13 19:29:14,227 - Namespace(data_dir='data/self_processed/', output_dir='hparam_search/', data_name='Diginetica', train_name='SASRec_Diginetica', num_items=10, num_users=14829, lr=0.001, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='SASRec', max_seq_length=50, hidden_size=64, num_hidden_layers=2, hidden_act='gelu', num_attention_heads=2, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, cuda_condition=True, data_file='data/self_processed/Diginetica.txt', item_size=9441, checkpoint_path=PosixPath('/gpfs/home3/scur2771/BSARec/BSARec/src/hparam_search/SASRec_Diginetica/12362200_2/model.pt'), same_target_path='data/self_processed/Diginetica_same_target.npy')
2025-06-13 19:29:14,244 - SASRecModel(
  (item_embeddings): Embedding(9441, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (item_encoder): TransformerEncoder(
    (blocks): ModuleList(
      (0): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
        )
      )
      (1): TransformerBlock(
        (layer): MultiHeadAttention(
          (query): Linear(in_features=64, out_features=64, bias=True)
          (key): Linear(in_features=64, out_features=64, bias=True)
          (value): Linear(in_features=64, out_features=64, bias=True)
          (softmax): Softmax(dim=-1)
          (attn_dropout): Dropout(p=0.5, inplace=False)
          (dense): Linear(in_features=64, out_features=64, bias=True)
          (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
          (out_dropout): Dropout(p=0.5, inplace=False)
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
        )
      )
    )
  )
)
2025-06-13 19:29:16,449 - Total Parameters: 707520
2025-06-13 19:29:23,764 - {'epoch': 0, 'rec_loss': '1.2636'}
2025-06-13 19:29:28,155 - {'Epoch': 0, 'HR@5': '0.0114', 'NDCG@5': '0.0079', 'HR@10': '0.0175', 'NDCG@10': '0.0099', 'HR@20': '0.0275', 'NDCG@20': '0.0124'}
2025-06-13 19:29:28,157 - Validation score increased.  Saving model ...
2025-06-13 19:29:34,768 - {'epoch': 1, 'rec_loss': '1.0567'}
2025-06-13 19:29:39,141 - {'Epoch': 1, 'HR@5': '0.0388', 'NDCG@5': '0.0262', 'HR@10': '0.0578', 'NDCG@10': '0.0324', 'HR@20': '0.0841', 'NDCG@20': '0.0390'}
2025-06-13 19:29:39,143 - Validation score increased.  Saving model ...
2025-06-13 19:29:45,883 - {'epoch': 2, 'rec_loss': '0.8955'}
2025-06-13 19:29:50,337 - {'Epoch': 2, 'HR@5': '0.0565', 'NDCG@5': '0.0372', 'HR@10': '0.0877', 'NDCG@10': '0.0472', 'HR@20': '0.1269', 'NDCG@20': '0.0571'}
2025-06-13 19:29:50,339 - Validation score increased.  Saving model ...
2025-06-13 19:29:56,949 - {'epoch': 3, 'rec_loss': '0.7588'}
2025-06-13 19:30:01,137 - {'Epoch': 3, 'HR@5': '0.0693', 'NDCG@5': '0.0442', 'HR@10': '0.1094', 'NDCG@10': '0.0571', 'HR@20': '0.1624', 'NDCG@20': '0.0704'}
2025-06-13 19:30:01,139 - Validation score increased.  Saving model ...
2025-06-13 19:30:07,909 - {'epoch': 4, 'rec_loss': '0.6448'}
2025-06-13 19:30:12,114 - {'Epoch': 4, 'HR@5': '0.0879', 'NDCG@5': '0.0564', 'HR@10': '0.1430', 'NDCG@10': '0.0741', 'HR@20': '0.2090', 'NDCG@20': '0.0907'}
2025-06-13 19:30:12,116 - Validation score increased.  Saving model ...
2025-06-13 19:30:18,775 - {'epoch': 5, 'rec_loss': '0.5577'}
2025-06-13 19:30:22,864 - {'Epoch': 5, 'HR@5': '0.0970', 'NDCG@5': '0.0619', 'HR@10': '0.1553', 'NDCG@10': '0.0807', 'HR@20': '0.2298', 'NDCG@20': '0.0994'}
2025-06-13 19:30:22,865 - Validation score increased.  Saving model ...
2025-06-13 19:30:29,588 - {'epoch': 6, 'rec_loss': '0.4965'}
2025-06-13 19:30:33,602 - {'Epoch': 6, 'HR@5': '0.1012', 'NDCG@5': '0.0645', 'HR@10': '0.1645', 'NDCG@10': '0.0849', 'HR@20': '0.2432', 'NDCG@20': '0.1047'}
2025-06-13 19:30:33,605 - Validation score increased.  Saving model ...
2025-06-13 19:30:40,221 - {'epoch': 7, 'rec_loss': '0.4494'}
2025-06-13 19:30:44,324 - {'Epoch': 7, 'HR@5': '0.1062', 'NDCG@5': '0.0675', 'HR@10': '0.1662', 'NDCG@10': '0.0868', 'HR@20': '0.2499', 'NDCG@20': '0.1079'}
2025-06-13 19:30:44,325 - Validation score increased.  Saving model ...
2025-06-13 19:30:50,975 - {'epoch': 8, 'rec_loss': '0.4213'}
2025-06-13 19:30:54,981 - {'Epoch': 8, 'HR@5': '0.1072', 'NDCG@5': '0.0691', 'HR@10': '0.1737', 'NDCG@10': '0.0904', 'HR@20': '0.2574', 'NDCG@20': '0.1115'}
2025-06-13 19:30:54,982 - Validation score increased.  Saving model ...
2025-06-13 19:31:01,600 - {'epoch': 9, 'rec_loss': '0.3973'}
2025-06-13 19:31:05,608 - {'Epoch': 9, 'HR@5': '0.1107', 'NDCG@5': '0.0705', 'HR@10': '0.1724', 'NDCG@10': '0.0904', 'HR@20': '0.2571', 'NDCG@20': '0.1118'}
2025-06-13 19:31:05,610 - Validation score increased.  Saving model ...
2025-06-13 19:31:12,279 - {'epoch': 10, 'rec_loss': '0.3825'}
2025-06-13 19:31:16,235 - {'Epoch': 10, 'HR@5': '0.1128', 'NDCG@5': '0.0722', 'HR@10': '0.1758', 'NDCG@10': '0.0924', 'HR@20': '0.2613', 'NDCG@20': '0.1140'}
2025-06-13 19:31:16,237 - Validation score increased.  Saving model ...
2025-06-13 19:31:22,895 - {'epoch': 11, 'rec_loss': '0.3636'}
2025-06-13 19:31:26,777 - {'Epoch': 11, 'HR@5': '0.1092', 'NDCG@5': '0.0694', 'HR@10': '0.1704', 'NDCG@10': '0.0892', 'HR@20': '0.2598', 'NDCG@20': '0.1117'}
2025-06-13 19:31:26,778 - EarlyStopping counter: 1 out of 10
2025-06-13 19:31:33,319 - {'epoch': 12, 'rec_loss': '0.3586'}
2025-06-13 19:31:37,299 - {'Epoch': 12, 'HR@5': '0.1073', 'NDCG@5': '0.0680', 'HR@10': '0.1737', 'NDCG@10': '0.0893', 'HR@20': '0.2609', 'NDCG@20': '0.1113'}
2025-06-13 19:31:37,302 - EarlyStopping counter: 2 out of 10
2025-06-13 19:31:44,040 - {'epoch': 13, 'rec_loss': '0.3434'}
2025-06-13 19:31:47,854 - {'Epoch': 13, 'HR@5': '0.1053', 'NDCG@5': '0.0663', 'HR@10': '0.1737', 'NDCG@10': '0.0883', 'HR@20': '0.2633', 'NDCG@20': '0.1108'}
2025-06-13 19:31:47,856 - EarlyStopping counter: 3 out of 10
2025-06-13 19:31:54,454 - {'epoch': 14, 'rec_loss': '0.3360'}
2025-06-13 19:31:58,232 - {'Epoch': 14, 'HR@5': '0.1056', 'NDCG@5': '0.0672', 'HR@10': '0.1719', 'NDCG@10': '0.0885', 'HR@20': '0.2606', 'NDCG@20': '0.1108'}
2025-06-13 19:31:58,234 - EarlyStopping counter: 4 out of 10
2025-06-13 19:32:04,807 - {'epoch': 15, 'rec_loss': '0.3335'}
2025-06-13 19:32:08,766 - {'Epoch': 15, 'HR@5': '0.1097', 'NDCG@5': '0.0689', 'HR@10': '0.1728', 'NDCG@10': '0.0892', 'HR@20': '0.2623', 'NDCG@20': '0.1117'}
2025-06-13 19:32:08,767 - EarlyStopping counter: 5 out of 10
2025-06-13 19:32:15,422 - {'epoch': 16, 'rec_loss': '0.3269'}
2025-06-13 19:32:19,425 - {'Epoch': 16, 'HR@5': '0.1079', 'NDCG@5': '0.0681', 'HR@10': '0.1768', 'NDCG@10': '0.0903', 'HR@20': '0.2669', 'NDCG@20': '0.1130'}
2025-06-13 19:32:19,428 - EarlyStopping counter: 6 out of 10
2025-06-13 19:32:26,032 - {'epoch': 17, 'rec_loss': '0.3220'}
2025-06-13 19:32:29,902 - {'Epoch': 17, 'HR@5': '0.1065', 'NDCG@5': '0.0673', 'HR@10': '0.1753', 'NDCG@10': '0.0894', 'HR@20': '0.2666', 'NDCG@20': '0.1123'}
2025-06-13 19:32:29,904 - EarlyStopping counter: 7 out of 10
2025-06-13 19:32:36,595 - {'epoch': 18, 'rec_loss': '0.3190'}
2025-06-13 19:32:40,431 - {'Epoch': 18, 'HR@5': '0.1074', 'NDCG@5': '0.0674', 'HR@10': '0.1747', 'NDCG@10': '0.0890', 'HR@20': '0.2651', 'NDCG@20': '0.1119'}
2025-06-13 19:32:40,433 - EarlyStopping counter: 8 out of 10
2025-06-13 19:32:47,112 - {'epoch': 19, 'rec_loss': '0.3133'}
2025-06-13 19:32:51,079 - {'Epoch': 19, 'HR@5': '0.1060', 'NDCG@5': '0.0682', 'HR@10': '0.1732', 'NDCG@10': '0.0897', 'HR@20': '0.2636', 'NDCG@20': '0.1125'}
2025-06-13 19:32:51,080 - EarlyStopping counter: 9 out of 10
2025-06-13 19:32:57,688 - {'epoch': 20, 'rec_loss': '0.3098'}
2025-06-13 19:33:01,617 - {'Epoch': 20, 'HR@5': '0.1109', 'NDCG@5': '0.0692', 'HR@10': '0.1768', 'NDCG@10': '0.0904', 'HR@20': '0.2689', 'NDCG@20': '0.1136'}
2025-06-13 19:33:01,621 - EarlyStopping counter: 10 out of 10
2025-06-13 19:33:01,621 - Early stopping
2025-06-13 19:33:01,621 - ---------------Validation Score---------------
2025-06-13 19:33:05,582 - {'Epoch': 0, 'HR@5': '0.1128', 'NDCG@5': '0.0722', 'HR@10': '0.1758', 'NDCG@10': '0.0924', 'HR@20': '0.2613', 'NDCG@20': '0.1140'}
2025-06-13 19:33:05,583 - SASRec_Diginetica
2025-06-13 19:33:05,583 - {'Epoch': 0, 'HR@5': '0.1128', 'NDCG@5': '0.0722', 'HR@10': '0.1758', 'NDCG@10': '0.0924', 'HR@20': '0.2613', 'NDCG@20': '0.1140'}
