2025-06-14 00:03:17,599 - Namespace(data_dir='data/self_processed/', output_dir='hparam_search/', data_name='Diginetica', train_name='BSARec_Diginetica', num_items=10, num_users=14829, lr=0.0005, batch_size=256, epochs=200, no_cuda=False, log_freq=1, patience=10, num_workers=4, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', variance=5, model_type='BSARec', max_seq_length=50, hidden_size=64, num_hidden_layers=2, hidden_act='gelu', num_attention_heads=1, attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, c=5, alpha=0.9, cuda_condition=True, data_file='data/self_processed/Diginetica.txt', item_size=9441, checkpoint_path=PosixPath('/gpfs/home3/scur2771/BSARec/BSARec/src/hparam_search/BSARec_Diginetica/12367757_90/model.pt'), same_target_path='data/self_processed/Diginetica_same_target.npy')
2025-06-14 00:03:17,647 - BSARecModel(
  (item_embeddings): Embedding(9441, 64, padding_idx=0)
  (position_embeddings): Embedding(50, 64)
  (LayerNorm): LayerNorm()
  (dropout): Dropout(p=0.5, inplace=False)
  (item_encoder): BSARecEncoder(
    (blocks): ModuleList(
      (0): BSARecBlock(
        (layer): BSARecLayer(
          (filter_layer): FrequencyLayer(
            (out_dropout): Dropout(p=0.5, inplace=False)
            (LayerNorm): LayerNorm()
          )
          (attention_layer): MultiHeadAttention(
            (query): Linear(in_features=64, out_features=64, bias=True)
            (key): Linear(in_features=64, out_features=64, bias=True)
            (value): Linear(in_features=64, out_features=64, bias=True)
            (softmax): Softmax(dim=-1)
            (attn_dropout): Dropout(p=0.5, inplace=False)
            (dense): Linear(in_features=64, out_features=64, bias=True)
            (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
            (out_dropout): Dropout(p=0.5, inplace=False)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
        )
      )
      (1): BSARecBlock(
        (layer): BSARecLayer(
          (filter_layer): FrequencyLayer(
            (out_dropout): Dropout(p=0.5, inplace=False)
            (LayerNorm): LayerNorm()
          )
          (attention_layer): MultiHeadAttention(
            (query): Linear(in_features=64, out_features=64, bias=True)
            (key): Linear(in_features=64, out_features=64, bias=True)
            (value): Linear(in_features=64, out_features=64, bias=True)
            (softmax): Softmax(dim=-1)
            (attn_dropout): Dropout(p=0.5, inplace=False)
            (dense): Linear(in_features=64, out_features=64, bias=True)
            (LayerNorm): LayerNorm((64,), eps=1e-12, elementwise_affine=True)
            (out_dropout): Dropout(p=0.5, inplace=False)
          )
        )
        (feed_forward): FeedForward(
          (dense_1): Linear(in_features=64, out_features=256, bias=True)
          (dense_2): Linear(in_features=256, out_features=64, bias=True)
          (LayerNorm): LayerNorm()
          (dropout): Dropout(p=0.5, inplace=False)
        )
      )
    )
  )
)
2025-06-14 00:03:21,132 - Total Parameters: 707904
2025-06-14 00:03:29,935 - {'epoch': 0, 'rec_loss': '8.8481'}
2025-06-14 00:03:34,048 - {'Epoch': 0, 'HR@5': '0.0042', 'NDCG@5': '0.0025', 'HR@10': '0.0077', 'NDCG@10': '0.0036', 'HR@20': '0.0122', 'NDCG@20': '0.0048'}
2025-06-14 00:03:34,050 - Validation score increased.  Saving model ...
2025-06-14 00:03:41,436 - {'epoch': 1, 'rec_loss': '8.4612'}
2025-06-14 00:03:45,613 - {'Epoch': 1, 'HR@5': '0.0200', 'NDCG@5': '0.0136', 'HR@10': '0.0301', 'NDCG@10': '0.0168', 'HR@20': '0.0446', 'NDCG@20': '0.0205'}
2025-06-14 00:03:45,615 - Validation score increased.  Saving model ...
2025-06-14 00:03:53,087 - {'epoch': 2, 'rec_loss': '7.9556'}
2025-06-14 00:03:57,240 - {'Epoch': 2, 'HR@5': '0.0612', 'NDCG@5': '0.0404', 'HR@10': '0.0881', 'NDCG@10': '0.0491', 'HR@20': '0.1224', 'NDCG@20': '0.0578'}
2025-06-14 00:03:57,243 - Validation score increased.  Saving model ...
2025-06-14 00:04:04,663 - {'epoch': 3, 'rec_loss': '7.2424'}
2025-06-14 00:04:08,912 - {'Epoch': 3, 'HR@5': '0.0935', 'NDCG@5': '0.0614', 'HR@10': '0.1424', 'NDCG@10': '0.0771', 'HR@20': '0.1999', 'NDCG@20': '0.0916'}
2025-06-14 00:04:08,914 - Validation score increased.  Saving model ...
2025-06-14 00:04:16,377 - {'epoch': 4, 'rec_loss': '6.5449'}
2025-06-14 00:04:20,680 - {'Epoch': 4, 'HR@5': '0.1145', 'NDCG@5': '0.0753', 'HR@10': '0.1770', 'NDCG@10': '0.0955', 'HR@20': '0.2464', 'NDCG@20': '0.1130'}
2025-06-14 00:04:20,682 - Validation score increased.  Saving model ...
2025-06-14 00:04:28,168 - {'epoch': 5, 'rec_loss': '6.0030'}
2025-06-14 00:04:32,481 - {'Epoch': 5, 'HR@5': '0.1302', 'NDCG@5': '0.0857', 'HR@10': '0.1991', 'NDCG@10': '0.1080', 'HR@20': '0.2797', 'NDCG@20': '0.1283'}
2025-06-14 00:04:32,483 - Validation score increased.  Saving model ...
2025-06-14 00:04:39,973 - {'epoch': 6, 'rec_loss': '5.6190'}
2025-06-14 00:04:44,288 - {'Epoch': 6, 'HR@5': '0.1428', 'NDCG@5': '0.0938', 'HR@10': '0.2170', 'NDCG@10': '0.1177', 'HR@20': '0.3043', 'NDCG@20': '0.1397'}
2025-06-14 00:04:44,290 - Validation score increased.  Saving model ...
2025-06-14 00:04:51,661 - {'epoch': 7, 'rec_loss': '5.3466'}
2025-06-14 00:04:56,018 - {'Epoch': 7, 'HR@5': '0.1511', 'NDCG@5': '0.0997', 'HR@10': '0.2282', 'NDCG@10': '0.1246', 'HR@20': '0.3228', 'NDCG@20': '0.1485'}
2025-06-14 00:04:56,021 - Validation score increased.  Saving model ...
2025-06-14 00:05:03,361 - {'epoch': 8, 'rec_loss': '5.1529'}
2025-06-14 00:05:07,694 - {'Epoch': 8, 'HR@5': '0.1583', 'NDCG@5': '0.1040', 'HR@10': '0.2404', 'NDCG@10': '0.1304', 'HR@20': '0.3332', 'NDCG@20': '0.1539'}
2025-06-14 00:05:07,696 - Validation score increased.  Saving model ...
2025-06-14 00:05:15,268 - {'epoch': 9, 'rec_loss': '5.0186'}
2025-06-14 00:05:19,622 - {'Epoch': 9, 'HR@5': '0.1627', 'NDCG@5': '0.1075', 'HR@10': '0.2456', 'NDCG@10': '0.1342', 'HR@20': '0.3436', 'NDCG@20': '0.1589'}
2025-06-14 00:05:19,624 - Validation score increased.  Saving model ...
2025-06-14 00:05:27,095 - {'epoch': 10, 'rec_loss': '4.9222'}
2025-06-14 00:05:31,468 - {'Epoch': 10, 'HR@5': '0.1651', 'NDCG@5': '0.1084', 'HR@10': '0.2499', 'NDCG@10': '0.1357', 'HR@20': '0.3488', 'NDCG@20': '0.1608'}
2025-06-14 00:05:31,471 - Validation score increased.  Saving model ...
2025-06-14 00:05:38,935 - {'epoch': 11, 'rec_loss': '4.8471'}
2025-06-14 00:05:43,334 - {'Epoch': 11, 'HR@5': '0.1670', 'NDCG@5': '0.1109', 'HR@10': '0.2552', 'NDCG@10': '0.1393', 'HR@20': '0.3522', 'NDCG@20': '0.1638'}
2025-06-14 00:05:43,335 - Validation score increased.  Saving model ...
2025-06-14 00:05:50,717 - {'epoch': 12, 'rec_loss': '4.7949'}
2025-06-14 00:05:55,135 - {'Epoch': 12, 'HR@5': '0.1720', 'NDCG@5': '0.1126', 'HR@10': '0.2569', 'NDCG@10': '0.1399', 'HR@20': '0.3562', 'NDCG@20': '0.1650'}
2025-06-14 00:05:55,138 - Validation score increased.  Saving model ...
2025-06-14 00:06:02,637 - {'epoch': 13, 'rec_loss': '4.7555'}
2025-06-14 00:06:07,086 - {'Epoch': 13, 'HR@5': '0.1720', 'NDCG@5': '0.1142', 'HR@10': '0.2566', 'NDCG@10': '0.1414', 'HR@20': '0.3572', 'NDCG@20': '0.1669'}
2025-06-14 00:06:07,089 - Validation score increased.  Saving model ...
2025-06-14 00:06:14,524 - {'epoch': 14, 'rec_loss': '4.7194'}
2025-06-14 00:06:18,933 - {'Epoch': 14, 'HR@5': '0.1721', 'NDCG@5': '0.1137', 'HR@10': '0.2605', 'NDCG@10': '0.1422', 'HR@20': '0.3607', 'NDCG@20': '0.1675'}
2025-06-14 00:06:18,935 - Validation score increased.  Saving model ...
2025-06-14 00:06:26,438 - {'epoch': 15, 'rec_loss': '4.6952'}
2025-06-14 00:06:30,758 - {'Epoch': 15, 'HR@5': '0.1701', 'NDCG@5': '0.1132', 'HR@10': '0.2600', 'NDCG@10': '0.1422', 'HR@20': '0.3627', 'NDCG@20': '0.1681'}
2025-06-14 00:06:30,760 - Validation score increased.  Saving model ...
2025-06-14 00:06:38,208 - {'epoch': 16, 'rec_loss': '4.6763'}
2025-06-14 00:06:42,480 - {'Epoch': 16, 'HR@5': '0.1725', 'NDCG@5': '0.1136', 'HR@10': '0.2597', 'NDCG@10': '0.1417', 'HR@20': '0.3614', 'NDCG@20': '0.1675'}
2025-06-14 00:06:42,482 - EarlyStopping counter: 1 out of 10
2025-06-14 00:06:49,878 - {'epoch': 17, 'rec_loss': '4.6506'}
2025-06-14 00:06:54,243 - {'Epoch': 17, 'HR@5': '0.1720', 'NDCG@5': '0.1133', 'HR@10': '0.2596', 'NDCG@10': '0.1416', 'HR@20': '0.3609', 'NDCG@20': '0.1673'}
2025-06-14 00:06:54,244 - EarlyStopping counter: 2 out of 10
2025-06-14 00:07:01,740 - {'epoch': 18, 'rec_loss': '4.6323'}
2025-06-14 00:07:06,076 - {'Epoch': 18, 'HR@5': '0.1721', 'NDCG@5': '0.1138', 'HR@10': '0.2619', 'NDCG@10': '0.1426', 'HR@20': '0.3634', 'NDCG@20': '0.1683'}
2025-06-14 00:07:06,079 - Validation score increased.  Saving model ...
2025-06-14 00:07:13,433 - {'epoch': 19, 'rec_loss': '4.6193'}
2025-06-14 00:07:17,760 - {'Epoch': 19, 'HR@5': '0.1733', 'NDCG@5': '0.1140', 'HR@10': '0.2605', 'NDCG@10': '0.1420', 'HR@20': '0.3632', 'NDCG@20': '0.1681'}
2025-06-14 00:07:17,763 - EarlyStopping counter: 1 out of 10
2025-06-14 00:07:25,141 - {'epoch': 20, 'rec_loss': '4.6064'}
2025-06-14 00:07:29,401 - {'Epoch': 20, 'HR@5': '0.1760', 'NDCG@5': '0.1164', 'HR@10': '0.2632', 'NDCG@10': '0.1444', 'HR@20': '0.3649', 'NDCG@20': '0.1702'}
2025-06-14 00:07:29,403 - Validation score increased.  Saving model ...
2025-06-14 00:07:36,855 - {'epoch': 21, 'rec_loss': '4.5961'}
2025-06-14 00:07:41,209 - {'Epoch': 21, 'HR@5': '0.1760', 'NDCG@5': '0.1150', 'HR@10': '0.2634', 'NDCG@10': '0.1431', 'HR@20': '0.3650', 'NDCG@20': '0.1688'}
2025-06-14 00:07:41,211 - EarlyStopping counter: 1 out of 10
2025-06-14 00:07:48,700 - {'epoch': 22, 'rec_loss': '4.5835'}
2025-06-14 00:07:53,085 - {'Epoch': 22, 'HR@5': '0.1736', 'NDCG@5': '0.1140', 'HR@10': '0.2640', 'NDCG@10': '0.1432', 'HR@20': '0.3651', 'NDCG@20': '0.1688'}
2025-06-14 00:07:53,086 - EarlyStopping counter: 2 out of 10
2025-06-14 00:08:00,461 - {'epoch': 23, 'rec_loss': '4.5718'}
2025-06-14 00:08:04,826 - {'Epoch': 23, 'HR@5': '0.1741', 'NDCG@5': '0.1138', 'HR@10': '0.2640', 'NDCG@10': '0.1427', 'HR@20': '0.3640', 'NDCG@20': '0.1680'}
2025-06-14 00:08:04,831 - EarlyStopping counter: 3 out of 10
2025-06-14 00:08:12,307 - {'epoch': 24, 'rec_loss': '4.5637'}
2025-06-14 00:08:16,676 - {'Epoch': 24, 'HR@5': '0.1733', 'NDCG@5': '0.1132', 'HR@10': '0.2629', 'NDCG@10': '0.1421', 'HR@20': '0.3647', 'NDCG@20': '0.1678'}
2025-06-14 00:08:16,679 - EarlyStopping counter: 4 out of 10
2025-06-14 00:08:24,165 - {'epoch': 25, 'rec_loss': '4.5477'}
2025-06-14 00:08:28,514 - {'Epoch': 25, 'HR@5': '0.1742', 'NDCG@5': '0.1150', 'HR@10': '0.2638', 'NDCG@10': '0.1439', 'HR@20': '0.3651', 'NDCG@20': '0.1695'}
2025-06-14 00:08:28,516 - EarlyStopping counter: 5 out of 10
2025-06-14 00:08:35,930 - {'epoch': 26, 'rec_loss': '4.5451'}
2025-06-14 00:08:40,245 - {'Epoch': 26, 'HR@5': '0.1732', 'NDCG@5': '0.1145', 'HR@10': '0.2636', 'NDCG@10': '0.1436', 'HR@20': '0.3637', 'NDCG@20': '0.1690'}
2025-06-14 00:08:40,247 - EarlyStopping counter: 6 out of 10
2025-06-14 00:08:47,610 - {'epoch': 27, 'rec_loss': '4.5357'}
2025-06-14 00:08:51,900 - {'Epoch': 27, 'HR@5': '0.1759', 'NDCG@5': '0.1145', 'HR@10': '0.2660', 'NDCG@10': '0.1436', 'HR@20': '0.3630', 'NDCG@20': '0.1681'}
2025-06-14 00:08:51,901 - EarlyStopping counter: 7 out of 10
2025-06-14 00:08:59,478 - {'epoch': 28, 'rec_loss': '4.5201'}
2025-06-14 00:09:03,859 - {'Epoch': 28, 'HR@5': '0.1740', 'NDCG@5': '0.1140', 'HR@10': '0.2650', 'NDCG@10': '0.1434', 'HR@20': '0.3624', 'NDCG@20': '0.1680'}
2025-06-14 00:09:03,862 - EarlyStopping counter: 8 out of 10
2025-06-14 00:09:11,267 - {'epoch': 29, 'rec_loss': '4.5172'}
2025-06-14 00:09:15,691 - {'Epoch': 29, 'HR@5': '0.1734', 'NDCG@5': '0.1143', 'HR@10': '0.2628', 'NDCG@10': '0.1430', 'HR@20': '0.3604', 'NDCG@20': '0.1677'}
2025-06-14 00:09:15,693 - EarlyStopping counter: 9 out of 10
2025-06-14 00:09:23,059 - {'epoch': 30, 'rec_loss': '4.5098'}
2025-06-14 00:09:27,405 - {'Epoch': 30, 'HR@5': '0.1743', 'NDCG@5': '0.1141', 'HR@10': '0.2634', 'NDCG@10': '0.1427', 'HR@20': '0.3621', 'NDCG@20': '0.1677'}
2025-06-14 00:09:27,408 - EarlyStopping counter: 10 out of 10
2025-06-14 00:09:27,408 - Early stopping
2025-06-14 00:09:27,408 - ---------------Validation Score---------------
2025-06-14 00:09:31,774 - {'Epoch': 0, 'HR@5': '0.1760', 'NDCG@5': '0.1164', 'HR@10': '0.2632', 'NDCG@10': '0.1444', 'HR@20': '0.3649', 'NDCG@20': '0.1702'}
2025-06-14 00:09:31,776 - BSARec_Diginetica
2025-06-14 00:09:31,776 - {'Epoch': 0, 'HR@5': '0.1760', 'NDCG@5': '0.1164', 'HR@10': '0.2632', 'NDCG@10': '0.1444', 'HR@20': '0.3649', 'NDCG@20': '0.1702'}
